/* Copyright 2023 Carlos A. (https://github.com/dealfonso); License: https://opensource.org/license/mit/ */
(function(e,a){defaultOptions={indentation:"  ",remove:"h1 h2 h3 h4 h5 h6 p",hide:false,skip:false,skipChildren:false,hidePlugin:true,removeAttributes:null,class:"showsource"};function r(i,e={},s=""){let t={};if(i.dataset.showsourceIndentation!==undefined){t.indentation=i.dataset.showsourceIndentation}if(i.dataset.showsourceRemove!==undefined){t.remove=i.dataset.showsourceRemove}if(i.dataset.showsourceHide!==undefined){t.hide=i.dataset.showsourceHide.toLowerCase()!="false"}if(i.dataset.showsourceSkip!==undefined){t.skip=i.dataset.showsourceSkip.toLowerCase()!="false"}if(i.dataset.showsourceSkipChildren!==undefined){t.skipChildren=i.dataset.showsourceSkipChildren.toLowerCase()!="false"}if(i.dataset.showsourceHidePlugin!==undefined){t.hidePlugin=i.dataset.showsourceHidePlugin.toLowerCase()!="false"}let n=Object.assign({},defaultOptions,t,e);if(n.skip){return[]}i=i.cloneNode(true);let a=Object.assign({},e,{indentation:n.indentation,hidePlugin:n.hidePlugin});if(typeof n.remove==="string"){let e=n.remove.split(" ").join(",");if(e.trim()!=""){i.querySelectorAll(e).forEach(function(e){e.remove()})}}let o=[];if(!n.hide){o.push(s+"<"+i.tagName.toLowerCase());let e=false;let t=[];if(typeof n.removeAttributes==="string"){t=n.removeAttributes.split(" ")}for(attribute of i.attributes){if(attribute.name.startsWith("data-showsource")){if(n.hidePlugin){continue}}if(t.includes(attribute.name)){continue}if(attribute.name.startsWith("data-")||e){o.push("  "+s+attribute.name+'="'+attribute.value+'"')}else{o[o.length-1]+=" "+attribute.name+'="'+attribute.value+'"'}e=attribute.name.startsWith("data-")}}if(i.children.length==0&&!n.hide){let e=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];if(e.includes(i.tagName.toLowerCase())){o[o.length-1]+=">"+i.innerHTML.trim()}else{let e=["script","style"];if(e.includes(i.tagName.toLowerCase())){o[o.length-1]+=">";let e=i.innerHTML.split("\n");while(e.length>0&&e[0].trim()==""){e.shift()}while(e.length>0&&e[e.length-1].trim()==""){e.pop()}o.push(e.join("\n"));o.push("</"+i.tagName.toLowerCase()+">")}else{if(o.length>1){o[o.length-1]+=">"+i.innerHTML.trim();o.push(s+"</"+i.tagName.toLowerCase()+">")}else{o[o.length-1]+=">"+i.innerHTML.trim()+"</"+i.tagName.toLowerCase()+">"}}}}else{if(!n.hide){o[o.length-1]+=">"}if(!n.skipChildren){for(child of i.childNodes){if(child.nodeType==Node.TEXT_NODE){let e=child.textContent.trim();if(e!==""){o.push(s+n.indentation+e)}}else{let e=r(child,a,s+(n.hide?"":n.indentation));o=o.concat(e)}}}if(!n.hide){o.push(s+"</"+i.tagName.toLowerCase()+">")}}i.remove();return o}function t(){a.querySelectorAll("div[data-showsource]").forEach(function(e){let t=defaultOptions.class;if(e.dataset.showsourceClass!==undefined){if(typeof e.dataset.showsourceClass==="string"){t=e.dataset.showsourceClass}else{console.error("The value of the data-showsource-class attribute must be a string")}}let i=a.createElement("div");let s=a.createElement("pre");let n=a.createElement("code");n.textContent=r(e).join("\n");s.appendChild(n);i.appendChild(s);t.split(" ").forEach(function(e){i.classList.add(e)});e.parentNode.insertBefore(i,e.nextSibling)})}if(a.addEventListener){a.addEventListener("DOMContentLoaded",function(){t()})}e.showsource={beautify:r,init:t}})(window,documen);
