/* Copyright 2023 Carlos A. (https://github.com/dealfonso); License: https://opensource.org/license/mit/ */
(function(s,r){"use strict";let o={indentation:"  ",hide:false,hideSelector:null,hideSelectorAdd:null,skip:false,skipSelector:null,skipSelectorAdd:null,skipChildren:false,hidePlugin:true,removeAttributes:null,class:"showsource",tagLineBreak:null,maxAttributesPerLine:null,separateElements:null};function c(a,e={},l=""){let t={};if(a.dataset.showsourceIndentation!==undefined){t.indentation=a.dataset.showsourceIndentation}if(a.dataset.showsourceSkipSelector!==undefined){t.skipSelector=a.dataset.showsourceSkipSelector}if(a.dataset.showsourceSkipSelectorAdd!==undefined){t.skipSelectorAdd=a.dataset.showsourceSkipSelectorAdd}if(a.dataset.showsourceHide!==undefined){t.hide=a.dataset.showsourceHide.toLowerCase()!="false"}if(a.dataset.showsourceHideSelector!==undefined){t.hideSelector=a.dataset.showsourceHideSelector}if(a.dataset.showsourceHideSelectorAdd!==undefined){t.hideSelectorAdd=a.dataset.showsourceHideSelectorAdd}if(a.dataset.showsourceSkip!==undefined){t.skip=a.dataset.showsourceSkip.toLowerCase()!="false"}if(a.dataset.showsourceSkipChildren!==undefined){t.skipChildren=a.dataset.showsourceSkipChildren.toLowerCase()!="false"}if(a.dataset.showsourceHidePlugin!==undefined){t.hidePlugin=a.dataset.showsourceHidePlugin.toLowerCase()!="false"}if(a.dataset.showsourceTagLineBreak!=undefined){t.tagLineBreak=parseInt(a.dataset.showsourceTagLineBreak)}if(a.dataset.showsourceMaxAttributesPerLine!=undefined){t.maxAttributesPerLine=parseInt(a.dataset.showsourceMaxAttributesPerLine)}if(a.dataset.showsourceSeparateElements!=undefined){t.separateElements=a.dataset.showsourceSeparateElements}let d=Object.assign({},o,s.showsource.defaults,t,e);if(d.skip){return[]}if(typeof d.skipSelector==="string"){let e=d.skipSelector.split(",").filter(e=>e.trim()!=="").join(",");if(e.trim()!=""){if(a.matches(e)){return[]}}}if(typeof d.skipSelectorAdd==="string"){if(d.skipSelector===undefined||d.skipSelector===null){d.skipSelector=d.skipSelectorAdd}else{d.skipSelector+=", "+d.skipSelectorAdd}}if(typeof d.hideSelectorAdd==="string"){if(d.hideSelector===undefined||d.hideSelector===null){d.hideSelector=d.hideSelectorAdd}else{d.hideSelector+=","+d.hideSelectorAdd}}let i=Object.assign({},e,{indentation:d.indentation,hidePlugin:d.hidePlugin,tagLineBreak:d.tagLineBreak,maxAttributesPerLine:d.maxAttributesPerLine,separateElements:d.separateElements,skipSelector:d.skipSelector,hideSelector:d.hideSelector});let u=[];if(!d.hide){if(typeof d.hideSelector==="string"){let e=d.hideSelector.split(",").filter(e=>e.trim()!=="").join(",");if(e.trim()!=""){d.hide=a.matches(e)}}}if(!d.hide){u.push(l+"<"+a.tagName.toLowerCase());let s=[];if(typeof d.removeAttributes==="string"){s=d.removeAttributes.split(" ")}let n=[];if(typeof d.separateElements==="string"){let t=d.separateElements.split(" ");for(let e of t){e=e.replace(/\*/g,".*");n.push(new RegExp(e))}}let r=0;let o=null;for(let i of a.attributes){if(i.name.startsWith("data-showsource")){if(d.hidePlugin){continue}}if(s.includes(i.name)){continue}let e=`${i.name}="${i.value}"`;let t=null;if(n.length>0){for(let e of n){if(e.test(i.name)){t=e;break}}}if(t!==null){u.push(" "+l+e);r=1;o=t;continue}if(o!==null){u.push(" "+l+e);r=1;o=null;continue}if(d.maxAttributesPerLine!==null&&r>=d.maxAttributesPerLine){u.push(" "+l+e);r=1;continue}if(d.tagLineBreak!==null&&e.length+u[u.length-1].length>d.tagLineBreak){u.push(" "+l+e);r=1;continue}u[u.length-1]+=" "+e;r++}}if(a.children.length==0&&!d.hide){let e=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];if(e.includes(a.tagName.toLowerCase())){u[u.length-1]+=">"+a.innerHTML.trim()}else{let e=["script","style"];if(e.includes(a.tagName.toLowerCase())){u[u.length-1]+=">";let e=a.innerHTML.split("\n");while(e.length>0&&e[0].trim()==""){e.shift()}while(e.length>0&&e[e.length-1].trim()==""){e.pop()}u.push(e.join("\n"));u.push(l+"</"+a.tagName.toLowerCase()+">")}else{if(u.length>1){u[u.length-1]+=">"+a.innerHTML.trim();u.push(l+"</"+a.tagName.toLowerCase()+">")}else{u[u.length-1]+=">"+a.innerHTML.trim()+"</"+a.tagName.toLowerCase()+">"}}}}else{if(!d.hide){u[u.length-1]+=">"}if(!d.skipChildren){for(let t of a.childNodes){if(t.nodeType==Node.TEXT_NODE){let e=t.textContent.trim();if(e!==""){u.push(l+d.indentation+e)}}else{let e=c(t,i,l+(d.hide?"":d.indentation));u=u.concat(e)}}}if(!d.hide){u.push(l+"</"+a.tagName.toLowerCase()+">")}}return u}function e(e="div[data-showsource]"){r.querySelectorAll(e).forEach(function(e){let t=o.class;if(e.dataset.showsourceClass!==undefined){if(typeof e.dataset.showsourceClass==="string"){t=e.dataset.showsourceClass}else{console.error("The value of the data-showsource-class attribute must be a string")}}let i=r.createElement("div");let s=r.createElement("pre");let n=r.createElement("code");n.textContent=c(e).join("\n");s.appendChild(n);i.appendChild(s);t.split(" ").forEach(function(e){i.classList.add(e)});e.parentNode.insertBefore(i,e.nextSibling)})}if(r.addEventListener){r.addEventListener("DOMContentLoaded",function(){e()})}s.showsource={defaults:Object.assign({},o),extract:c,show:e,version:"1.2.1"}})(window,document);
