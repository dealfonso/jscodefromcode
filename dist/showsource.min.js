/* Copyright 2023 Carlos A. (https://github.com/dealfonso); License: https://opensource.org/license/mit/ */
(function(i,a){"use strict";let o={indentation:"  ",remove:"h1 h2 h3 h4 h5 h6 p",hide:false,skip:false,skipChildren:false,hidePlugin:true,removeAttributes:null,class:"showsource",tagLineBreak:null,maxAttributesPerLine:null,separateElements:null};function h(r,e={},l=""){let t={};if(r.dataset.showsourceIndentation!==undefined){t.indentation=r.dataset.showsourceIndentation}if(r.dataset.showsourceRemove!==undefined){t.remove=r.dataset.showsourceRemove}if(r.dataset.showsourceHide!==undefined){t.hide=r.dataset.showsourceHide.toLowerCase()!="false"}if(r.dataset.showsourceSkip!==undefined){t.skip=r.dataset.showsourceSkip.toLowerCase()!="false"}if(r.dataset.showsourceSkipChildren!==undefined){t.skipChildren=r.dataset.showsourceSkipChildren.toLowerCase()!="false"}if(r.dataset.showsourceHidePlugin!==undefined){t.hidePlugin=r.dataset.showsourceHidePlugin.toLowerCase()!="false"}if(r.dataset.showsourceTagLineBreak!=undefined){t.tagLineBreak=parseInt(r.dataset.showsourceTagLineBreak)}if(r.dataset.showsourceMaxAttributesPerLine!=undefined){t.maxAttributesPerLine=parseInt(r.dataset.showsourceMaxAttributesPerLine)}if(r.dataset.showsourceSeparateElements!=undefined){t.separateElements=r.dataset.showsourceSeparateElements}let u=Object.assign({},o,i.showsource.defaults,t,e);if(u.skip){return[]}r=r.cloneNode(true);let s=Object.assign({},e,{indentation:u.indentation,hidePlugin:u.hidePlugin,tagLineBreak:u.tagLineBreak,maxAttributesPerLine:u.maxAttributesPerLine,separateElements:u.separateElements});if(typeof u.remove==="string"){let e=u.remove.split(" ").join(",");if(e.trim()!=""){r.querySelectorAll(e).forEach(function(e){e.remove()})}}let d=[];if(!u.hide){d.push(l+"<"+r.tagName.toLowerCase());let i=[];if(typeof u.removeAttributes==="string"){i=u.removeAttributes.split(" ")}let n=[];if(typeof u.separateElements==="string"){let t=u.separateElements.split(" ");for(let e of t){e=e.replace(/\*/g,".*");n.push(new RegExp(e))}}let a=0;let o=null;for(let s of r.attributes){if(s.name.startsWith("data-showsource")){if(u.hidePlugin){continue}}if(i.includes(s.name)){continue}let e=`${s.name}="${s.value}"`;let t=null;if(n.length>0){for(let e of n){if(e.test(s.name)){t=e;break}}}if(t!==null){d.push(" "+l+e);a=1;o=t;continue}if(o!==null){d.push(" "+l+e);a=1;o=null;continue}if(u.maxAttributesPerLine!==null&&a>=u.maxAttributesPerLine){d.push(" "+l+e);a=1;continue}if(u.tagLineBreak!==null&&e.length+d[d.length-1].length>u.tagLineBreak){d.push(" "+l+e);a=1;continue}d[d.length-1]+=" "+e;a++}}if(r.children.length==0&&!u.hide){let e=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];if(e.includes(r.tagName.toLowerCase())){d[d.length-1]+=">"+r.innerHTML.trim()}else{let e=["script","style"];if(e.includes(r.tagName.toLowerCase())){d[d.length-1]+=">";let e=r.innerHTML.split("\n");while(e.length>0&&e[0].trim()==""){e.shift()}while(e.length>0&&e[e.length-1].trim()==""){e.pop()}d.push(e.join("\n"));d.push("</"+r.tagName.toLowerCase()+">")}else{if(d.length>1){d[d.length-1]+=">"+r.innerHTML.trim();d.push(l+"</"+r.tagName.toLowerCase()+">")}else{d[d.length-1]+=">"+r.innerHTML.trim()+"</"+r.tagName.toLowerCase()+">"}}}}else{if(!u.hide){d[d.length-1]+=">"}if(!u.skipChildren){for(let t of r.childNodes){if(t.nodeType==Node.TEXT_NODE){let e=t.textContent.trim();if(e!==""){d.push(l+u.indentation+e)}}else{let e=h(t,s,l+(u.hide?"":u.indentation));d=d.concat(e)}}}if(!u.hide){d.push(l+"</"+r.tagName.toLowerCase()+">")}}r.remove();return d}function e(){a.querySelectorAll("div[data-showsource]").forEach(function(e){let t=o.class;if(e.dataset.showsourceClass!==undefined){if(typeof e.dataset.showsourceClass==="string"){t=e.dataset.showsourceClass}else{console.error("The value of the data-showsource-class attribute must be a string")}}let s=a.createElement("div");let i=a.createElement("pre");let n=a.createElement("code");n.textContent=h(e).join("\n");i.appendChild(n);s.appendChild(i);t.split(" ").forEach(function(e){s.classList.add(e)});e.parentNode.insertBefore(s,e.nextSibling)})}if(a.addEventListener){a.addEventListener("DOMContentLoaded",function(){e()})}i.showsource={defaults:Object.assign({},o),beautify:h,init:e,version:"1.1.1"}})(window,document);
